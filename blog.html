---
layout: default
title: Blog
---

<div class="home-layout">
  <main class="main-content">
    <h1>All Posts</h1>

    <!-- page size selector -->
    <div class="posts-controls" style="display:flex; justify-content:flex-end; gap:0.5rem; align-items:center; margin-bottom:0.75rem;">
      <label for="page-size-select" class="page-size-label">페이지당:</label>
      <select id="page-size-select" class="page-size-select">
        <option value="5">5</option>
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="50">50</option>
      </select>
    </div>

    <div id="posts-wrapper">
      <div id="posts-list"><!-- rendered by JS --></div>

      <div id="no-posts" style="display: none;">
        <p>No posts found. Create your first post in the <code>_posts</code> directory.</p>
      </div>

      <nav id="pagination" class="pagination" aria-label="Pagination"></nav>
    </div>
  </main>

  <!-- Category Sidebar Web Component -->
  <category-sidebar 
    categories-data='[{% assign categories = site.categories | sort %}{% for category in categories %}{% unless forloop.first %},{% endunless %}{"name":"{{ category[0] }}","count":{{ category[1].size }}}{% endfor %}]'
    total-posts="{{ site.posts.size }}">
  </category-sidebar>
</div>

<!-- posts data (JSON generated by Jekyll) -->
<script>
window.__posts = [
{% for post in site.posts %}
  {
    "title": {{ post.title | jsonify }},
    "url": {{ post.url | relative_url | jsonify }},
    "date": {{ post.date | date: "%B %d, %Y" | jsonify }},
    "excerpt": {{ post.excerpt | strip_html | truncatewords: 30 | jsonify }},
    "categories": {{ post.categories | jsonify }},
    "tags": {{ post.tags | jsonify }},
    "readingTime": {{ post.content | strip_html | number_of_words | divided_by: 200 | plus: 1 }}
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
];
</script>

<script src="{{ '/assets/js/blog-pagination.js' | relative_url }}"></script>
<script>
/* filepath: /Users/jeongcool/me/my-tech-blog/blog.html - client pagination renderer (clean) */
document.addEventListener('DOMContentLoaded', function () {
  const postsData = window.__posts || [];
  const postsList = document.getElementById('posts-list');
  const noPosts = document.getElementById('no-posts');
  const pagination = document.getElementById('pagination');
  const pageSizeSelect = document.getElementById('page-size-select');

  function parseHash() {
    const hash = (location.hash || '').replace(/^#/, '');
    const parts = hash.split('&').filter(Boolean);
    const params = {};
    parts.forEach(p => {
      const [k, v] = p.split('=');
      if (k) params[k] = v;
    });
    return params;
  }

  function renderPostCard(post) {
    const article = document.createElement('article');
    article.className = 'post-preview';
    const h2 = document.createElement('h2');
    const a = document.createElement('a');
    a.href = post.url;
    a.textContent = post.title;
    h2.appendChild(a);

    const meta = document.createElement('p');
    meta.className = 'post-meta';
    meta.textContent = post.date;
    if (post.categories && post.categories.length) {
      meta.textContent += ' • ' + post.categories.join(', ');
    }

    const excerpt = document.createElement('p');
    excerpt.innerHTML = post.excerpt;

    article.appendChild(h2);
    article.appendChild(meta);
    article.appendChild(excerpt);
    return article;
  }

  // initial pageSize: hash > localStorage > default 10
  const saved = parseInt(localStorage.getItem('blog_page_size') || '', 10);
  const hashParams = parseHash();
  let pageSize = hashParams.psize ? parseInt(hashParams.psize, 10) : (isNaN(saved) ? 10 : saved);
  if (!pageSize || pageSize <= 0) pageSize = 10;
  pageSizeSelect.value = String(pageSize);

  if (!postsData.length) {
    postsList.style.display = 'none';
    noPosts.style.display = 'block';
    pagination.style.display = 'none';
    pageSizeSelect.style.display = 'none';
    return;
  }

  const windowSize = 5;

  function buildHash(page, psize) {
    const parts = [];
    if (page) parts.push('p=' + page);
    if (psize) parts.push('psize=' + psize);
    return '#' + parts.join('&');
  }

  function renderPage(page) {
    const totalPages = Math.max(1, Math.ceil(postsData.length / pageSize));
    if (page < 1) page = 1;
    if (page > totalPages) page = totalPages;

    postsList.innerHTML = '';
    const start = (page - 1) * pageSize;
    const end = Math.min(start + pageSize, postsData.length);
    for (let i = start; i < end; i++) {
      postsList.appendChild(renderPostCard(postsData[i]));
    }

    renderControls(page, totalPages);
    history.replaceState(null, '', buildHash(page, pageSize));
    window.scrollTo({ top: 0 });
  }

  function createBtn(label, page, disabled) {
    const a = document.createElement('a');
    a.className = 'page-link' + (disabled ? ' disabled' : '');
    a.href = 'javascript:void(0)';
    a.textContent = label;
    a.addEventListener('click', function (e) {
      e.preventDefault();
      if (disabled) return;
      renderPage(page);
    });
    return a;
  }

  function renderControls(current, totalPages) {
    pagination.innerHTML = '';
    if (totalPages <= 1) return;

    pagination.appendChild(createBtn('First', 1, current === 1));
    pagination.appendChild(createBtn('«', Math.max(1, current - 1), current === 1));

    let half = Math.floor(windowSize / 2);
    let start = Math.max(1, current - half);
    let end = Math.min(totalPages, start + windowSize - 1);
    if (end - start < windowSize - 1) start = Math.max(1, end - windowSize + 1);

    for (let p = start; p <= end; p++) {
      const btn = createBtn(String(p), p, false);
      if (p === current) btn.classList.add('current');
      pagination.appendChild(btn);
    }

    pagination.appendChild(createBtn('»', Math.min(totalPages, current + 1), current === totalPages));
    pagination.appendChild(createBtn('Last', totalPages, current === totalPages));
  }

  pageSizeSelect.addEventListener('change', function () {
    const newSize = parseInt(this.value, 10) || 10;
    pageSize = newSize;
    localStorage.setItem('blog_page_size', String(pageSize));
    renderPage(1);
  });

  const initialPage = hashParams.p ? parseInt(hashParams.p, 10) : 1;
  renderPage(initialPage || 1);

  window.addEventListener('hashchange', function () {
    const params = parseHash();
    if (params.psize) {
      const psize = parseInt(params.psize, 10);
      if (!isNaN(psize) && psize > 0 && psize !== pageSize) {
        pageSize = psize;
        pageSizeSelect.value = String(pageSize);
        localStorage.setItem('blog_page_size', String(pageSize));
      }
    }
    const p = params.p ? parseInt(params.p, 10) : 1;
    renderPage(p);
  });
});
</script>
