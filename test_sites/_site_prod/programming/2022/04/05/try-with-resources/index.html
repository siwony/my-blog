<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Try-with-resources</title><link rel="stylesheet" href="/assets/css/prism/prism-material-theme.css"><link rel="stylesheet" href="/assets/css/prism/prism-toolbar.min.css"><link rel="stylesheet" href="/assets/css/prism/prism-line-numbers.min.css"><link rel="stylesheet" href="/assets/css/style.css"><script type="module" src="https://unpkg.com/ninja-keys?module"></script></head><body><div class="container"><header><h1><a href="/">My Tech Blog</a></h1><nav><ul><li><a href="/">Home</a></li></ul></nav></header><main><article class="post"><header class="post-header"><h1 class="post-title">Try-with-resources</h1><post-metadata layout="inline" categories='["programming"]' tags='["TIL","grammar","coding","development","java"]' date="April 05, 2022" reading-time="2" compact="false"></post-metadata><div class="post-author"><span class="author-label">작성자:</span> <span class="author-name">jeongcool</span></div></header><div class="post-content"><h1 id="try-with-resources">Try-with-resources</h1><p>해당 문법은 <code>try(...)</code>에서 선언된 객체들에 대해 try가 종료될 떄 자동으로 자원을 해제해주는 기능히다.</p><ul><li>try에서 선언된 객체가 AutoCloseable을 구현하면 Java는 try구문이 종료될 때 객체의 <code>close()</code> 메소드를 호출한다.</li><li>Java7 버전에 추가되었다.</li></ul><h3 id="1-java7-이전의-자원-해제-방법">1. Java7 이전의 자원 해제 방법</h3><p>input.txt를 읽는 코드입니다.</p><pre><code class="language-java">public class ResourceClose {
    public static void main(String[] args) {
        Scanner scanner = null;
        try {
            // scanner 생성
            scanner = new Scanner(new File("input.txt"));
            System.out.println(scanner.nextLine());
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } finally {
            // scanner 리소스 반납
            if (scanner != null) 
                scanner.close();
        }
    }
}
</code></pre><p>여기에서는 try에서 Scanner객체를 생성한 후 finally에서 close를 해줬다.</p><p>이경우에는 finally를 통해 무조건 자원을 해제 해줘야 하고 혹시 모를 NPE를 대비해 null체크를 했다. 이런 코드를 Java7부터 다음과 같이 사용할 수 있다.</p><h3 id="2-java7-이후의-자원-해제-방법">2. Java7 이후의 자원 해제 방법</h3><pre><code class="language-java">public class ResourceClose {
    public static void main(String[] args) {
        try (Scanner scanner = new Scanner(new File("input.txt"))){
            System.out.println(scanner.nextLine());
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
}
</code></pre><p>이 코드는 어느 곳에도 생성된 리소스를 반납하지 않아도 try옆 괄호 안에 있는 리소스에 대해 자동으로 <code>close()</code>가 호출된다.</p><p><code>try with resources</code>구분에 사용되는 리소스는 <code>java.lang.AutoCloseable</code> 인터페이스를 구현해야 한다.</p><p><code>Scanner</code>의 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html">공식 API 문서</a>를 보면 <code>java.lang.AutoCloseable</code>를 구현한 것을 볼 수 있다.</p><h3 id="3-java9에서-나온-개선사항">3. Java9에서 나온 개선사항</h3><p>Java7에서는 자원을 해제해야 하는 리소스를 반드시 try옆 괄호 안에 생성을 해야 한다.</p><p>하지만 Java9부터 변수를 통해 이를 해제할 수 있다.</p><pre><code class="language-java">public class ResourceClose {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(new File("input.txt"));
        try (scanner){
            System.out.println(scanner.nextLine());
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
}
</code></pre><h4 id="주의사항">주의사항</h4><ul><li>사용할 변수가 final이거나</li><li>effectively final(사실상 final)인 변수를 사용해야 한다.</li></ul></div><footer class="post-footer"><div class="post-navigation"><div class="nav-previous"><span class="nav-label">이전 글</span> <a href="/programming/2022/04/05/package/" class="nav-link">Package</a></div><div class="nav-next"><span class="nav-label">다음 글</span> <a href="/programming/2022/04/05/%EB%B3%80%EC%88%98%EC%9D%98-scope-static/" class="nav-link">변수의 scope, static</a></div></div></footer></article></main></div><script src="/assets/js/prism/prism.min.js"></script><script src="/assets/js/prism/prism-autoloader.min.js"></script><script src="/assets/js/prism/prism-toolbar.min.js"></script><script src="/assets/js/prism/prism-copy-to-clipboard.min.js"></script><script src="/assets/js/prism/prism-show-language.min.js"></script><script src="/assets/js/prism/prism-line-numbers.min.js"></script><script>document.addEventListener("DOMContentLoaded",function(){Prism.plugins&&Prism.plugins.autoloader&&(Prism.plugins.autoloader.languages_path="/assets/js/prism/components/",console.log("Prism autoloader configured with local path:",Prism.plugins.autoloader.languages_path)),document.querySelectorAll('pre[class*="language-"]').forEach(function(s){s.classList.add("line-numbers")}),Prism.highlightAll()})</script><script src="/assets/js/command-palette.js"></script><script src="/assets/js/category-sidebar.js"></script><script src="/assets/js/post-metadata.js"></script></body></html>