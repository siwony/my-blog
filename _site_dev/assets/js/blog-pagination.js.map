{"version":3,"names":[],"mappings":"","sources":["blog-pagination.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function () {\n  const postsData = window.__posts || [];\n  const postsList = document.getElementById('posts-list');\n  const noPosts = document.getElementById('no-posts');\n  const pagination = document.getElementById('pagination');\n  const pageSizeSelect = document.getElementById('page-size-select');\n\n  function parseHash() {\n    const hash = (location.hash || '').replace(/^#/, '');\n    const parts = hash.split('&').filter(Boolean);\n    const params = {};\n    parts.forEach(p => {\n      const [k, v] = p.split('=');\n      if (k) params[k] = v;\n    });\n    return params;\n  }\n\n  function renderPostCard(post) {\n    const article = document.createElement('article');\n    article.className = 'post-preview';\n    const h2 = document.createElement('h2');\n    const a = document.createElement('a');\n    a.href = post.url;\n    a.textContent = post.title;\n    h2.appendChild(a);\n\n    // Create metadata web component for categories and tags\n    const metadataComponent = document.createElement('post-metadata');\n    metadataComponent.setAttribute('layout', 'badge');\n    if (post.categories && post.categories.length) {\n      metadataComponent.setAttribute('categories', JSON.stringify(post.categories));\n    }\n    if (post.tags && post.tags.length) {\n      metadataComponent.setAttribute('tags', JSON.stringify(post.tags));\n    }\n    metadataComponent.setAttribute('date', post.date);\n    metadataComponent.setAttribute('reading-time', post.readingTime || '5');\n\n    const excerpt = document.createElement('p');\n    excerpt.innerHTML = post.excerpt;\n\n    article.appendChild(h2);\n    article.appendChild(metadataComponent);\n    article.appendChild(excerpt);\n    return article;\n  }\n\n  // initial pageSize: hash > localStorage > default 10\n  const saved = parseInt(localStorage.getItem('blog_page_size') || '', 10);\n  const hashParams = parseHash();\n  let pageSize = hashParams.psize ? parseInt(hashParams.psize, 10) : (isNaN(saved) ? 10 : saved);\n  if (!pageSize || pageSize <= 0) pageSize = 10;\n  pageSizeSelect.value = String(pageSize);\n\n  if (!postsData.length) {\n    postsList.style.display = 'none';\n    noPosts.style.display = 'block';\n    pagination.style.display = 'none';\n    pageSizeSelect.style.display = 'none';\n    return;\n  }\n\n  function buildHash(page, psize) {\n    const parts = [];\n    if (page) parts.push('p=' + page);\n    if (psize) parts.push('psize=' + psize);\n    return '#' + parts.join('&');\n  }\n\n  function renderPage(page) {\n    const totalPages = Math.max(1, Math.ceil(postsData.length / pageSize));\n    if (page < 1) page = 1;\n    if (page > totalPages) page = totalPages;\n\n    postsList.innerHTML = '';\n    const start = (page - 1) * pageSize;\n    const end = Math.min(start + pageSize, postsData.length);\n    for (let i = start; i < end; i++) {\n      postsList.appendChild(renderPostCard(postsData[i]));\n    }\n\n    renderControls(page, totalPages);\n    history.replaceState(null, '', buildHash(page, pageSize));\n    window.scrollTo({ top: 0 });\n  }\n\n  function createBtn(label, page, disabled, isNavBtn = false) {\n    const a = document.createElement('a');\n    a.className = 'page-link' + (disabled ? ' disabled' : '') + (isNavBtn ? ' nav-btn' : '');\n    a.href = 'javascript:void(0)';\n    a.textContent = label;\n    a.addEventListener('click', function (e) {\n      e.preventDefault();\n      if (disabled) return;\n      renderPage(page);\n    });\n    return a;\n  }\n\n  // 화면 크기에 따라 표시할 페이지 수 결정\n  function getWindowSize() {\n    const screenWidth = window.innerWidth;\n    if (screenWidth < 480) return 3;      // 모바일: 3개\n    if (screenWidth < 768) return 5;      // 태블릿: 5개\n    if (screenWidth < 1024) return 7;     // 중간 화면: 7개\n    return 10;                            // 데스크톱: 10개\n  }\n\n  function renderControls(current, totalPages) {\n    pagination.innerHTML = '';\n    if (totalPages <= 1) return;\n\n    const windowSize = getWindowSize();\n    let half = Math.floor(windowSize / 2);\n    let start = Math.max(1, current - half);\n    let end = Math.min(totalPages, start + windowSize - 1);\n    if (end - start < windowSize - 1) start = Math.max(1, end - windowSize + 1);\n\n    // First 버튼 - 시작 페이지가 범위에 포함되지 않을 때만 표시\n    if (start > 1) {\n      pagination.appendChild(createBtn('First', 1, false, true));\n      // 구분을 위한 여백 추가\n      const spacer = document.createElement('span');\n      spacer.style.margin = '0 0.25rem';\n      pagination.appendChild(spacer);\n    }\n    \n    // Previous 버튼\n    pagination.appendChild(createBtn('‹', Math.max(1, current - 1), current === 1, true));\n\n    // 페이지 번호 버튼들\n    for (let p = start; p <= end; p++) {\n      const btn = createBtn(String(p), p, false);\n      if (p === current) btn.classList.add('current');\n      pagination.appendChild(btn);\n    }\n\n    // Next 버튼\n    pagination.appendChild(createBtn('›', Math.min(totalPages, current + 1), current === totalPages, true));\n    \n    // Last 버튼 - 끝 페이지가 범위에 포함되지 않을 때만 표시\n    if (end < totalPages) {\n      // 구분을 위한 여백 추가\n      const spacer = document.createElement('span');\n      spacer.style.margin = '0 0.25rem';\n      pagination.appendChild(spacer);\n      pagination.appendChild(createBtn('Last', totalPages, false, true));\n    }\n  }\n\n  pageSizeSelect.addEventListener('change', function () {\n    const newSize = parseInt(this.value, 10) || 10;\n    pageSize = newSize;\n    localStorage.setItem('blog_page_size', String(pageSize));\n    renderPage(1);\n  });\n\n  const initialPage = hashParams.p ? parseInt(hashParams.p, 10) : 1;\n  renderPage(initialPage || 1);\n\n  window.addEventListener('hashchange', function () {\n    const params = parseHash();\n    if (params.psize) {\n      const psize = parseInt(params.psize, 10);\n      if (!isNaN(psize) && psize > 0 && psize !== pageSize) {\n        pageSize = psize;\n        pageSizeSelect.value = String(pageSize);\n        localStorage.setItem('blog_page_size', String(pageSize));\n      }\n    }\n    const p = params.p ? parseInt(params.p, 10) : 1;\n    renderPage(p);\n  });\n\n  // 윈도우 리사이즈 시 페이지네이션 업데이트\n  let resizeTimer;\n  window.addEventListener('resize', function() {\n    clearTimeout(resizeTimer);\n    resizeTimer = setTimeout(function() {\n      const params = parseHash();\n      const currentPage = params.p ? parseInt(params.p, 10) : 1;\n      renderPage(currentPage);\n    }, 250);\n  });\n});\n"],"file":"blog-pagination.js"}