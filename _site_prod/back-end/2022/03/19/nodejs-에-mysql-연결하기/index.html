<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Node.js 에 MySQL 연결하기</title><link rel="stylesheet" href="/assets/css/prism/prism-material-theme.css"><link rel="stylesheet" href="/assets/css/prism/prism-toolbar.min.css"><link rel="stylesheet" href="/assets/css/prism/prism-line-numbers.min.css"><link rel="stylesheet" href="/assets/css/style.css"><script type="module" src="https://unpkg.com/ninja-keys?module"></script></head><body><div class="container"><header><h1><a href="/">My Tech Blog</a></h1><nav><ul><li><a href="/">Home</a></li></ul></nav></header><main><article class="post"><header class="post-header"><h1 class="post-title">Node.js 에 MySQL 연결하기</h1><post-metadata layout="inline" categories='["back-end"]' tags='["nodejs","TIL"]' date="March 19, 2022" reading-time="2" compact="false"></post-metadata><div class="post-author"><span class="author-label">작성자:</span> <span class="author-name">jeongcool</span></div></header><div class="post-content"><h1 id="nodejs-에-mysql-연결하기">Node.js 에 MySQL 연결하기</h1><h2 id="mysql-모듈을-설치합니다">MySQL 모듈을 설치합니다.</h2><pre><code class="language-bash">$ npm install mysql
</code></pre><h2 id="db연결하기">DB연결하기</h2><p>mysql 설치후 mysql 모듈을 설치합니다.</p><pre><code class="language-javascript">const mysql      = require('mysql');
const connection = mysql.createConnection({
  host     : 'localhost',  //호스트 주소
  user     : 'GF_test1',   //mysql user
  password : '1234',       //mysql password
  database : 'testGF8'     //mysql DB
});

connection.connect();

connection.query('SELECT * from test', (error, rows, fields) =&gt; {
  if (error) throw error;
  console.log('User info is: ', rows);
});

connection.end();
</code></pre><ul><li>connection 변수는 연결할 때 사용 되는 정보를 저장함</li><li>connect(); 함수가 mysql에 연결</li><li>query(‘mysql query’, callback); 에서 실제 데이터 베이스의 값을 다룸<br>mysql query 에너는 mysql query문이 들어감</li><li><code>end()</code> 함수를 통해 mysql 을 종료합니다.<br>query매세드에 select * from test 라는 쿼리문을 작성해서<br>test테이블에 있는 값을 꺼내 와 콘솔에 출력하는 코드를 작성해봤다. 콘솔에 출력하면 값은 값의 타입은 배열이고 컬럼은 JSON 방식인것을 알 수 있습니다.<br><img src="/assets/images/posts/back-end/node.js-mysql-select-query.png" alt="node-mysql-query"></li></ul><h3 id="if-오류가-뜬다면">IF 오류가 뜬다면?</h3><blockquote><p>Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested by server; consider upgrading MySQL client<br>만약 이런 애러가 11번째 줄에서 throw 되어서 나타났다면, 먼저 확인해야 될것은<br>user랑 password가 잘못되어 있을수도 있다.<br>그래도 에러가 뜬다면 유저에게 권환을 주지 않았거나, 유저 자체를 만들지 않았을 것이다.<br>지금부터 오류를 고쳐보다.</p></blockquote><h3 id="유저-조회">유저 조회</h3><p>일단은 유저를 관리하는 mysql 이라는 database에 접속을해야한다. <code>use mysql</code>를 입력한다.<br>그뒤 유저를 조회해보자</p><pre><code class="language-sql">&gt; select user, host from user;
</code></pre><p>그러면 유저랑, host가 보여질것이다. 여기서 host는 <code>localhost</code> local내에서 접속이 가능한것이고 <code>%</code> 는 어디서나 접속할 수 있다는것을 말한다. 이제 유저를 만들어 볼것이다. 유저를 이미 만들어져 있으면 유저 권한 설정으로 이동하면 된다.</p><h3 id="유저-생성-및-권환주기">유저 생성 및 권환주기</h3><pre><code class="language-sql">&gt; create user '유저이름'@'호스트(host)'identified with mysql_native_password by '비밀번호'
</code></pre><p>host에는 대표적으로 localhost, %가 있다.%은 외부에서도 접속이 가능하다는것이다.<br>host는 localhost로 하는게 안전하다. 꼭 필요하지 않는이상 localhost로 하는게 좋다.</p><pre><code class="language-sql">&gt; grant all privileges on . to '(유저이름)'@'%';
</code></pre><p>이렇게 하면 모든 데이터베이스에 접속이 가능하다.<br>하지만 모든 데이터베이스에 접속하는것은 위험하다. 그러므로</p><pre><code class="language-sql">&gt; grant all privileges on DB명.* to 유저(user)@localhost
--ex) grant all privileges on cat.* test@localhost
-- cat이라는 DB접속 권환을 test유저에게 localhost에서 사용가능하게 줬다.
</code></pre><p>이런식으로 특정 DB만 접속할 수 있도록 하는게 비교적 안전해진다.</p><h2 id="sequelize">Sequelize</h2><p>sequelize 는 node.js 의 ORM(Object Releaition Mapping) 모듈이다.<br>관계형 DB를 사용할떄 객체를 이용해 간편하게 쿼리문을 작성하지 않고 사용할 수 있게 해준다.<br>자세한 sequelize 사용법은 <a href="./sequelize.md">여기</a> 에서 확인할 수 있다.</p><h3 id="how-to-use">how to use?</h3><pre><code class="language-bash">&gt; npm install sequelize sequelize-cli --save
</code></pre><p>를 통해 모듈을 다운받고</p><pre><code class="language-bash">&gt; sequelize init
</code></pre><p>을 통해 sequelize 를 사용할 수 있게 파일구조나 필요한 설정파일들을 생성해준다.</p></div><footer class="post-footer"><div class="post-navigation"><div class="nav-previous"><span class="nav-label">이전 글</span> <a href="/back-end/2022/03/19/nodejs-%EC%84%A4%EC%B9%98mac/" class="nav-link">Node,Js 설치(mac)</a></div><div class="nav-next"><span class="nav-label">다음 글</span> <a href="/cs/2022/03/19/osi-7%EA%B3%84%EC%B8%B5/" class="nav-link">OSI 7계층</a></div></div></footer></article></main></div><script src="/assets/js/prism/prism.min.js"></script><script src="/assets/js/prism/prism-autoloader.min.js"></script><script src="/assets/js/prism/prism-toolbar.min.js"></script><script src="/assets/js/prism/prism-copy-to-clipboard.min.js"></script><script src="/assets/js/prism/prism-show-language.min.js"></script><script src="/assets/js/prism/prism-line-numbers.min.js"></script><script>document.addEventListener("DOMContentLoaded",function(){Prism.plugins&&Prism.plugins.autoloader&&(Prism.plugins.autoloader.languages_path="/assets/js/prism/components/",console.log("Prism autoloader configured with local path:",Prism.plugins.autoloader.languages_path)),document.querySelectorAll('pre[class*="language-"]').forEach(function(s){s.classList.add("line-numbers")}),Prism.highlightAll()})</script><script src="/assets/js/command-palette.js"></script><script src="/assets/js/category-sidebar.js"></script><script src="/assets/js/post-metadata.js"></script></body></html>