<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>서브쿼리</title><link rel="stylesheet" href="/assets/css/prism/prism-material-theme.css"><link rel="stylesheet" href="/assets/css/prism/prism-toolbar.min.css"><link rel="stylesheet" href="/assets/css/prism/prism-line-numbers.min.css"><link rel="stylesheet" href="/assets/css/style.css"><script type="module" src="https://unpkg.com/ninja-keys?module"></script></head><body><div class="container"><header><h1><a href="/">My Tech Blog</a></h1><nav><ul><li><a href="/">Home</a></li></ul></nav></header><main><article class="post"><header class="post-header"><h1 class="post-title">서브쿼리</h1><post-metadata layout="inline" categories='["database"]' tags='["sql","TIL"]' date="February 24, 2022" reading-time="2" compact="false"></post-metadata><div class="post-author"><span class="author-label">작성자:</span> <span class="author-name">jeongcool</span></div></header><div class="post-content"><h1 id="서브쿼리">서브쿼리</h1><p>하나의 쿼리 문장 내에 포함된 또 하나의 쿼리 문장</p><ul><li>비교연산자의 오른쪽에 기술해야 하고 반드시 괄호 안에 넣어야 함</li><li>메인쿼리가 실행되기 이전에 한 번만 실행됨</li></ul><h4 id="서브쿼리를-사용-가능한-곳">서브쿼리를 사용 가능한 곳</h4><ul><li>SELECT 절</li><li>FROM 절</li><li>WHERE 절</li><li>HAVING 절</li><li>ORDER BY 절</li><li>INSERT 문의 VALUSE 절</li><li>UPDATE 문의 SET 절</li></ul><h2 id="1-서브쿼리의-분류">1. 서브쿼리의 분류</h2><h3 id="1-1-스칼라-서브쿼리---scalar-subqueries">1-1. 스칼라 서브쿼리 - Scalar Subqueries</h3><p>SELECT 절 안에 서브쿼리가 들어있다.</p><ul><li>리턴할 수 있는 최대 데이터가 1개이다.<blockquote><p>서브쿼리의 결과는 반드시 <strong>단일 행</strong>이나 SUM, COUNT 등의 <strong>집계 함수를 거친 단일 값</strong>으로 리턴되어야 한다.</p></blockquote></li><li>찾고자 하는 데이터가 없는 경우 NULL를 반환한다.</li><li>값에 대한 캐싱이 가능하다.</li></ul><p>홍길동 학생의 학과를 조회한다고 가정하면 다음과 같다.</p><pre><code class="language-sql">SELECT 학생이름,
        (   
            SELECT 학과.학과이름
            FROM 학과
            WHERE 학과.학과ID = 학생.학생ID ) AS 학과이름
FROM 학생
WHERE 학생이름 = '홍길동';
</code></pre><h3 id="1-2-인라인-뷰-서브쿼리---inline-view-subqueries">1-2. 인라인 뷰 서브쿼리 - Inline View subqueries</h3><p>FROM 절 안에 서브쿼리가 들어있다.</p><ul><li>서브쿼리의 결과는 반드시 하나의 테이블로 리턴되어야 한다.<blockquote><p>서브쿼리를 끝마친 테이블 하나를 메인쿼리의 FROM 에서 테이블로 잡기 때문.</p></blockquote></li></ul><p>수학 과목을 수강하는 학생들의 수학점수를 조회한다고 가정하면 다음과 같다.</p><pre><code class="language-sql">SELECT 학생이름, 수학점수
FROM (   
        SELECT 학생.학생이름 AS 학생이름,
                과목.수학점수 AS 수학점수
        FROM 학생, 과목
        WHERE 학생.학생이름 = 과목.학생이름
        AND 과목.과목이름 = '수학'
    );
</code></pre><h3 id="1-3-중첩-서브쿼리---nested-subqueries">1-3. 중첩 서브쿼리 - Nested subqueries</h3><p>WHERE절 안에 서브쿼리가 들어있다.</p><ul><li>단일행과 복수행 둘 다 리턴이 가능하다.<blockquote><p>서브쿼리를 끝마친 값들을 메인쿼리의 조건절을 통해 비교등을 하기 때문.</p></blockquote></li></ul><p>수학 과목을 수강하는 학생들의 모든 정보를 조회한다고 가정하면 다음과 같다.</p><pre><code class="language-sql">SELECT *
FROM 학생
WHERE 학생.학생이름 IN (
    SELECT 과목.학생이름
    FROM 과목
    WHERE 과목.과목이름 = '수학'
);
</code></pre><h4 id="1-단일행-서브-쿼리">1. 단일행 서브 쿼리</h4><ul><li>서브쿼리의 수행결과가 오직 하나의 ROW(행)만을 반환한다.</li><li>이 하나의 결과를 가지고 메인쿼리는 비교연산자를 통해 쿼리를 수행한다.</li><li>비교연산자는 단일행 비교연산자를 사용한다.<blockquote><p>&gt;, &gt;=, &lt;, &lt;=, = …</p></blockquote></li></ul><p>사원들의 평균 급여보다 더 많은 급여를 받는 사원을 검색</p><pre><code class="language-sql">SELECT ENAME, SAL
FROM EMP
WHERE SAL &gt; ( 
    SELECT  AVG(SAL)
    FROM  EMP
);
</code></pre><h4 id="2-다중행-서브-쿼리">2. 다중행 서브 쿼리</h4><ul><li>서브쿼리의 수행결과가 두 건 이상의 데이터를 반환한다.</li><li>비교연산자는 다중행 비교연산자를 이용한다.<blockquote><p>IN, ANY, SOME, ALL, EXISTS</p></blockquote></li></ul><p>개발1팀 소속 사원 중 급여를 가장 많이 받는 사람의 이름과 급여를 검색</p><pre><code class="language-sql">SELECT  ENAME, SAL
FROM  EMP
WHERE  SAL &gt; ALL ( SELECT  SAL
                      FROM  EMP
                     WHERE  DEPTNAME = '개발1' );
</code></pre></div><footer class="post-footer"><div class="post-navigation"><div class="nav-previous"><span class="nav-label">이전 글</span> <a href="/database/2022/02/24/sql/" class="nav-link">SQL</a></div><div class="nav-next"><span class="nav-label">다음 글</span> <a href="/database/2022/02/26/%EC%A0%9C%EC%95%BD%EC%A1%B0%EA%B1%B4/" class="nav-link">제약조건</a></div></div></footer></article></main></div><script src="/assets/js/prism/prism.min.js"></script><script src="/assets/js/prism/prism-autoloader.min.js"></script><script src="/assets/js/prism/prism-toolbar.min.js"></script><script src="/assets/js/prism/prism-copy-to-clipboard.min.js"></script><script src="/assets/js/prism/prism-show-language.min.js"></script><script src="/assets/js/prism/prism-line-numbers.min.js"></script><script>document.addEventListener("DOMContentLoaded",function(){Prism.plugins&&Prism.plugins.autoloader&&(Prism.plugins.autoloader.languages_path="/assets/js/prism/components/",console.log("Prism autoloader configured with local path:",Prism.plugins.autoloader.languages_path)),document.querySelectorAll('pre[class*="language-"]').forEach(function(s){s.classList.add("line-numbers")}),Prism.highlightAll()})</script><script src="/assets/js/command-palette.js"></script><script src="/assets/js/category-sidebar.js"></script><script src="/assets/js/post-metadata.js"></script></body></html>