<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>트랜잭션 격리 수준 - Isolation level</title><link rel="stylesheet" href="/assets/css/prism/prism-material-theme.css"><link rel="stylesheet" href="/assets/css/prism/prism-toolbar.min.css"><link rel="stylesheet" href="/assets/css/prism/prism-line-numbers.min.css"><link rel="stylesheet" href="/assets/css/style.css"><script type="module" src="https://unpkg.com/ninja-keys?module"></script></head><body><div class="container"><header><h1><a href="/">My Tech Blog</a></h1><nav><ul><li><a href="/">Home</a></li></ul></nav></header><main><article class="post"><header class="post-header"><h1 class="post-title">트랜잭션 격리 수준 - Isolation level</h1><post-metadata layout="inline" categories='["database"]' tags='["TIL"]' date="January 18, 2022" reading-time="2" compact="false"></post-metadata><div class="post-author"><span class="author-label">작성자:</span> <span class="author-name">jeongcool</span></div></header><div class="post-content"><h1 id="트랜잭션-격리-수준---isolation-level">트랜잭션 격리 수준 - Isolation level</h1><p>트랜잭션 격리 수준은 동시에 여러 트랜잭션이 처리될 때, 트랜잭션끼리 얼마나 서로 고립되어 있는지를 나타내는 것이다</p><p>격리수준은 크게 4개로 나뉜다.</p><ul><li><a href="#1-read-uncommitted">Read Uncommitted</a></li><li><a href="#2-read-committed">Read Committed</a></li><li><a href="#3-repetable-read">Repeatable Read</a></li><li><a href="#4-serializable">Serializable</a></li></ul><p>위에서 아래로 갈수록 격리수준은 높아진다.</p><h2 id="1-격리성-관련-문제점">1. 격리성 관련 문제점</h2><h3 id="1-1-dirty-read">1-1. Dirty Read</h3><p><strong>다른 트랜잭션에 의해 수정됐지만 아직 커밋되지 않은 데이터를 읽는 것</strong></p><ol><li>트랜잭션 A가 1번 사원의 나이를 19 → 20로 변경하고 커밋하지 않았다.</li><li>트랜잭션 B는 1번 사원의 나이를 조회했더니 커밋하지 않았던 20을 조회했다.</li></ol><p><strong>만약 트랜잭션 A가 최종커밋을 하지 않는다면, 트랜잭션 B가 가지고 있는 데이터는 꼬이게된다.</strong></p><h3 id="1-2-non-repeatable-read">1-2. Non-Repeatable Read</h3><p>트랜잭션 내에서 같은 쿼리를 두번 수행할 때 두개의 쿼리가 다른 결과를 반환하는 현상 (비 일관성)</p><ol><li>트랜잭션 A는 현재 1번 사원의 나이가 19인 데이터를 조회하고 있다.</li><li>트랜잭션 B가 1번 사원의 나이를 19 → 20로 변경하고 커밋한다.</li><li>그후 트랜잭션 A가 다시 해당 데이터를 조회 하면 처음 조회랑 다른 20으로 변경된 데이터를 조회하게 된다.</li></ol><h3 id="1-3-phantom-read">1-3. Phantom Read</h3><p>한 트랜잭션 안에서 일정범위의 레코드를 두번 이상 읽을 때, 첫 번재 쿼리에서 없던 유령 레코드가 두번째 쿼리에서 나타나는 현상을 말한다.</p><ol><li>트랜잭션 A가 특정 조건으로 데이터를 검색하여 결과를 얻었다.</li><li>트랜잭션 B가 해당 조건의 데이터를 삭제 혹은 추가 해버렸다,</li><li>다시 해당 조건으로 트랜잭션 A가 데이터를 조회하면 이전에 트랜잭션 A에서 추가/삭제된 데이터가 함께 조회/누락 된다.</li></ol><p><strong>이 때 트랜잭션 B가 롤백하게 된다면 데이터가 꼬이게 된다.</strong></p><h2 id="2-트랜잭션-격리수준">2. 트랜잭션 격리수준</h2><h2 id="2-1-read-uncommitted-level-0">2-1. Read Uncommitted (level 0)</h2><p>어떤 트랜잭션의 처리중인 변경내용이 다른 트랜잭션에서 읽는 것을 허용한다.</p><ul><li>SELECT 문장이 수행되는 동안 해당 데이터에 Shared Lock이 걸리지 않는다.</li><li>트랜잭션에 처리중이거나, 아직 Commit 되지 않은 데이터를 다른 트랜잭션이 읽는 것을 허용한다.</li><li>데이터베이스의 <strong>일관성을 유지는 것이 불가능</strong>하다.</li></ul><h4 id="발생되는-문제점">발생되는 문제점</h4><p><code>Dirty Read</code>, <code>Non-Repeatable Read</code>, <code>Phantom Read</code></p><h2 id="2-2-read-committed-level-1">2-2. Read Committed (level 1)</h2><p>어떤 트랜잭션의 변경 내용이 COMMIT 되어야만 다른 트랜잭션에서 조회할 수 있다.</p><blockquote><p>Oracle DBMS에서 기본으로 사용된다.</p></blockquote><ul><li>Oracle, SQL Server</li></ul><h4 id="발생되는-문제점들">발생되는 문제점들</h4><p><code>Non-Repeatable Read</code>, <code>Phantom Read</code></p><p>금융 시스템에서 입/출금 과 연관된 금전적인 처리와 연결되어 있다면 문제가 발생할 수 있다.</p><h2 id="2-3-repetable-read-level-2">2-3. Repetable Read (level 2)</h2><p>트랜잭션이 시작되기 전에 커밋된 내용에 대해서만 조회할 수 있는 격리수준이다.</p><blockquote><p>MySQL DBMS에서 기본으로 사용한다.</p></blockquote><ol><li>A번 트랜잭션이 500000번 사원을 조회</li><li>B번 트랜잭션이 500000번 사원의 이름을 변경하고 커밋</li><li>A번 트랜잭션이 500000번 사원을 다시 조회</li><li><code>언두 - Undo</code> 영역에 백업된 데이터 반환</li></ol><p>즉, <strong>자신의 트랜잭션 번호보다 낮은 트랜잭션 번호에서 변경된(커밋된)것만 보게 되는 것 이다.</strong></p><h4 id="발생되는-문제점-1">발생되는 문제점</h4><p><code>Phantom Read</code></p><h2 id="2-4-serializable">2-4. Serializable</h2><p>격리수준이 Serializable일 경우 <strong>읽기 작업에도 공유 잠금</strong>을 설정하게 되고, 이러면 동시에 다른 트랜잭션에서 이 레코드를 변경하지 못하게 된다.</p><ul><li>동시처리 능력이 떨어진다.</li><li>성능저하가 발생하게 된다.</li></ul></div><footer class="post-footer"><div class="post-navigation"><div class="nav-previous"><span class="nav-label">이전 글</span> <a href="/devops/2021/12/04/ssh-secure-shell-protocol/" class="nav-link">SSH (Secure Shell Protocol)</a></div><div class="nav-next"><span class="nav-label">다음 글</span> <a href="/algorithm/2022/01/30/%EB%B2%84%EB%B8%94-%EC%A0%95%EB%A0%AC-bubble-sort/" class="nav-link">버블 정렬 - Bubble Sort</a></div></div></footer></article></main></div><script src="/assets/js/prism/prism.min.js"></script><script src="/assets/js/prism/prism-autoloader.min.js"></script><script src="/assets/js/prism/prism-toolbar.min.js"></script><script src="/assets/js/prism/prism-copy-to-clipboard.min.js"></script><script src="/assets/js/prism/prism-show-language.min.js"></script><script src="/assets/js/prism/prism-line-numbers.min.js"></script><script>document.addEventListener("DOMContentLoaded",function(){Prism.plugins&&Prism.plugins.autoloader&&(Prism.plugins.autoloader.languages_path="/assets/js/prism/components/",console.log("Prism autoloader configured with local path:",Prism.plugins.autoloader.languages_path)),document.querySelectorAll('pre[class*="language-"]').forEach(function(s){s.classList.add("line-numbers")}),Prism.highlightAll()})</script><script src="/assets/js/command-palette.js"></script><script src="/assets/js/category-sidebar.js"></script><script src="/assets/js/post-metadata.js"></script></body></html>